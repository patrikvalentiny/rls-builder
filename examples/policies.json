[
  {
    "id": "8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e",
    "name": "Line managers view their line's results",
    "schema": "production",
    "table": "test_results",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "exists (select 1 from production_lines pl where pl.id = test_results.line_id and pl.manager_id = auth.uid())",
    "withCheck": "",
    "collection": "PLIS Reporting",
    "documentation": "Managers can only view performance data (charging speed, vacuum levels) for production lines they explicitly manage.",
    "createdAt": 1766405300000,
    "updatedAt": 1766405300000
  },
  {
    "id": "9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f",
    "name": "Quality Assurance can view all traceability data",
    "schema": "production",
    "table": "product_traceability",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' IN ('quality_admin', 'plant_manager')",
    "withCheck": "",
    "collection": "Quality Control",
    "documentation": "Grants global read access to product history (barcodes, components, leak checks) for QA staff.",
    "createdAt": 1766405400000,
    "updatedAt": 1766405400000
  },
  {
    "id": "0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5g",
    "name": "Engineers can update process parameters",
    "schema": "configuration",
    "table": "recipes",
    "as": "PERMISSIVE",
    "for": "UPDATE",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'process_engineer'",
    "withCheck": "auth.jwt() ->> 'role' = 'process_engineer'",
    "collection": "Device Configuration",
    "documentation": "Allows Process Engineers to modify charging recipes (e.g., target weight, pressure limits) synchronized to devices.",
    "createdAt": 1766405500000,
    "updatedAt": 1766405500000
  },
  {
    "id": "1e2f3a4b-5c6d-7e8f-9a0b-1c2d3e4f5g6h",
    "name": "Operators can view active recipes",
    "schema": "configuration",
    "table": "recipes",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "is_active = true AND exists (select 1 from station_assignments sa where sa.user_id = auth.uid() and sa.line_id = recipes.line_id)",
    "withCheck": "",
    "collection": "Device Configuration",
    "documentation": "Shop floor operators can only see currently active recipes relevant to the line they are assigned to.",
    "createdAt": 1766405600000,
    "updatedAt": 1766405600000
  },
  {
    "id": "2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5g6h7i",
    "name": "Technicians can log repair actions",
    "schema": "maintenance",
    "table": "repair_logs",
    "as": "PERMISSIVE",
    "for": "INSERT",
    "to": "authenticated",
    "using": "",
    "withCheck": "auth.uid() = technician_id",
    "collection": "Rework & Repair",
    "documentation": "Ensures repair technicians can only log rework actions (e.g., 'compressor replaced') under their own identity.",
    "createdAt": 1766405700000,
    "updatedAt": 1766405700000
  },
  {
    "id": "3a4b5c6d-7e8f-9a0b-1c2d-3e4f5g6h7i8j",
    "name": "Prevent deletion of compliance data",
    "schema": "production",
    "table": "compliance_certs",
    "as": "PERMISSIVE",
    "for": "DELETE",
    "to": "authenticated",
    "using": "false",
    "withCheck": "",
    "collection": "Compliance",
    "documentation": "Strictly forbids deletion of regulatory compliance certificates (e.g., ISO safety checks) by any user role.",
    "createdAt": 1766405800000,
    "updatedAt": 1766405800000
  },
  {
    "id": "4b5c6d7e-8f9a-0b1c-2d3e-4f5g6h7i8j9k",
    "name": "Read access for 3rd party auditing",
    "schema": "production",
    "table": "daily_summaries",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'external_auditor' AND tenant_id = (auth.jwt() ->> 'tenant_id')::uuid",
    "withCheck": "",
    "collection": "External Auditing",
    "documentation": "Allows external auditors read-only access to aggregated daily summaries for their specific tenant.",
    "createdAt": 1766405900000,
    "updatedAt": 1766405900000
  },
  {
    "id": "5c6d7e8f-9a0b-1c2d-3e4f-5g6h7i8j9k0l",
    "name": "Inventory managers update refrigerant stock",
    "schema": "logistics",
    "table": "refrigerant_inventory",
    "as": "PERMISSIVE",
    "for": "UPDATE",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'inventory_manager'",
    "withCheck": "auth.jwt() ->> 'role' = 'inventory_manager'",
    "collection": "Supply Chain",
    "documentation": "Restricts updates to refrigerant tank levels and consumption data to designated inventory managers.",
    "createdAt": 1766406000000,
    "updatedAt": 1766406000000
  },
  {
    "id": "6d7e8f9a-0b1c-2d3e-4f5g-6h7i8j9k0l1m",
    "name": "Technicians update device calibration",
    "schema": "maintenance",
    "table": "device_calibration",
    "as": "PERMISSIVE",
    "for": "INSERT",
    "to": "authenticated",
    "using": "",
    "withCheck": "auth.jwt() ->> 'role' IN ('technician', 'service_engineer')",
    "collection": "Device Maintenance",
    "documentation": "Allows technicians to log new calibration certificates for charging stations and leak detectors.",
    "createdAt": 1766406100000,
    "updatedAt": 1766406100000
  },
  {
    "id": "7e8f9a0b-1c2d-3e4f-5g6h-7i8j9k0l1m2n",
    "name": "Employees report safety incidents",
    "schema": "safety",
    "table": "incidents",
    "as": "PERMISSIVE",
    "for": "INSERT",
    "to": "authenticated",
    "using": "",
    "withCheck": "auth.uid() = reporter_id",
    "collection": "EHS",
    "documentation": "Enables any authenticated employee to report safety incidents or near-misses on the production line.",
    "createdAt": 1766406200000,
    "updatedAt": 1766406200000
  },
  {
    "id": "8f9a0b1c-2d3e-4f5g-6h7i-8j9k0l1m2n3o",
    "name": "Safety officers resolve incidents",
    "schema": "safety",
    "table": "incidents",
    "as": "PERMISSIVE",
    "for": "UPDATE",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'safety_officer'",
    "withCheck": "auth.jwt() ->> 'role' = 'safety_officer'",
    "collection": "EHS",
    "documentation": "Only designated safety officers can update incident status, add investigation notes, or close reports.",
    "createdAt": 1766406300000,
    "updatedAt": 1766406300000
  },
  {
    "id": "9a0b1c2d-3e4f-5g6h-7i8j-9k0l1m2n3o4p",
    "name": "Admins manage PLIS global settings",
    "schema": "system",
    "table": "plis_settings",
    "as": "PERMISSIVE",
    "for": "ALL",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'system_admin'",
    "withCheck": "auth.jwt() ->> 'role' = 'system_admin'",
    "collection": "System Administration",
    "documentation": "Full access to global PLIS configuration (integrations, feature flags) restricted to system administrators.",
    "createdAt": 1766406400000,
    "updatedAt": 1766406400000
  },
  {
    "id": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
    "name": "Quality Admins delete invalid tests",
    "schema": "production",
    "table": "test_results",
    "as": "PERMISSIVE",
    "for": "DELETE",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'quality_admin'",
    "withCheck": "",
    "collection": "PLIS Data Collection",
    "documentation": "Allows Quality Administrators to remove erroneous test results from the system.",
    "createdAt": 1766406500000,
    "updatedAt": 1766406500000
  },
  {
    "id": "b2c3d4e5-f678-9012-3456-7890abcdef12",
    "name": "Plant Managers create recipes",
    "schema": "configuration",
    "table": "recipes",
    "as": "PERMISSIVE",
    "for": "INSERT",
    "to": "authenticated",
    "using": "",
    "withCheck": "auth.jwt() ->> 'role' = 'plant_manager'",
    "collection": "Device Configuration",
    "documentation": "Enables Plant Managers to define new charging recipes for production lines.",
    "createdAt": 1766406600000,
    "updatedAt": 1766406600000
  },
  {
    "id": "c3d4e5f6-7890-1234-5678-90abcdef1234",
    "name": "View repair history for line",
    "schema": "maintenance",
    "table": "repair_logs",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "exists (select 1 from production_lines pl where pl.id = repair_logs.line_id and pl.manager_id = auth.uid())",
    "withCheck": "",
    "collection": "Rework & Repair",
    "documentation": "Line managers can review repair logs associated with their specific production line.",
    "createdAt": 1766406700000,
    "updatedAt": 1766406700000
  },
  {
    "id": "d4e5f678-9012-3456-7890-abcdef123456",
    "name": "View open safety incidents",
    "schema": "safety",
    "table": "incidents",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "status = 'open'",
    "withCheck": "",
    "collection": "EHS",
    "documentation": "Allows all employees to view currently open safety incidents to maintain awareness.",
    "createdAt": 1766406800000,
    "updatedAt": 1766406800000
  },
  {
    "id": "e5f67890-1234-5678-90ab-cdef12345678",
    "name": "Auditors check inventory",
    "schema": "logistics",
    "table": "refrigerant_inventory",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'external_auditor'",
    "withCheck": "",
    "collection": "Supply Chain",
    "documentation": "External auditors can verify refrigerant inventory levels for compliance reporting.",
    "createdAt": 1766406900000,
    "updatedAt": 1766406900000
  },
  {
    "id": "f6789012-3456-7890-abcd-ef1234567890",
    "name": "Support view system config",
    "schema": "system",
    "table": "plis_settings",
    "as": "PERMISSIVE",
    "for": "SELECT",
    "to": "authenticated",
    "using": "auth.jwt() ->> 'role' = 'support_staff'",
    "withCheck": "",
    "collection": "System Administration",
    "documentation": "Support staff can view system configurations to assist with troubleshooting but cannot modify them.",
    "createdAt": 1766407000000,
    "updatedAt": 1766407000000
  }
]